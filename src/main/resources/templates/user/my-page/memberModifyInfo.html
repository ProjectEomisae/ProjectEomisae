<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<!--/*@thymesVar id="user" type="dev.dmchoi.eomisae.entities.member.UserEntity"*/-->
<!--/*@thymesVar id="modifyProfileVo" type="dev.dmchoi.eomisae.vos.member.user.UserModifyVo"*/-->
<!--/*@thymesVar id="result" type="java.lang.Enum<?>"*/-->
<!--/*@thymesVar id="user" type="dev.dmchoi.eomisae.entities.member.UserEntity"*/-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>어미새</title>
    <link th:href="@{/user/my-page/resources/stylesheets/memberModifyInfo.css}" rel="stylesheet">
    <link th:href="@{/resources/stylesheets/index.css}" rel="stylesheet">
    <link th:href="@{/resources/stylesheets/common.css}" rel="stylesheet">
    <script defer th:src="@{/resources/scripts/header.js}"></script>
    <script defer th:src="@{/user/my-page/resources/scripts/memberModifyInfo.js}"></script>
    <script src="https://kit.fontawesome.com/0d51ab0f86.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="https://eomisae.co.kr/files/attach/xeicon/favicon.ico">
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('FAILURE_DUPLICATE_USER_ID')}">
        alert('해당 아이디는 이미 사용중입니다.');
        window.history.back();
    </script>
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('FAILURE_DUPLICATE_NICKNAME')}">
        alert('해당 닉네임은 이미 사용중입니다.');
        window.history.back();
    </script>
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('ILLEGAL_USER_ID')}">
        alert('아아디의 값은 영문,숫자,_만 가능하며 첫 글자는 영문이어야 합니다.');
        window.history.back();
    </script>
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('ILLEGAL_NICKNAME')}">
        alert('닉네임의 값이 한글(2-5), 영문 또는 숫자(4-10)에 맞지 않습니다.');
        window.history.back();
    </script>
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('FAILURE')}">
        alert('알 수 없는 이유로 회원가입에 실패하였습니다.\n\n잠시 후 다시 시도해 주세요.');
        window.history.back();
    </script>
    <script th:if="${modifyProfileVo != null && modifyProfileVo.getResult().name().equals('SUCCESS')}">
        alert('회원정보 수정이 완료되었습니다.');
        window.location.href = '/user/my-page/memberInfo';
    </script>
</head>
<body>
<th:block th:replace="~{fragments/header.html :: content}"></th:block>
<th:block th:replace="~{fragments/myPageHeader.html :: content}"></th:block>
<main class="main" id="main">
    <form class="modify-profile-form" id="modifyProfileForm" method="post" enctype="multipart/form-data" th:action="@{/user/my-page/memberModifyInfo}">
        <section class="modify-profile">
            <h1 class="title">회원정보 조회/수정</h1>
            <div class="label-container">
                <label for="emailInput" class="control-label">
                    <span>이메일 주소</span>
                    <span class="star">*</span>
                </label>
                <label class="input-container">
                    <span hidden>이메일 주소</span>
                    <input required class="input input-email" id="emailInput" maxlength="50" name="email" type="email"
                           th:value="${user.getEmail()}" readonly>
                </label>
            </div>
            <div class="label-container">
                <label for="idInput" class="control-label">
                    <span>아이디</span>
                </label>
                <label class="input-container">
                    <span hidden>아이디</span>
                    <input class="input input-blue" id="idInput" maxlength="50" name="userId" type="text" th:value="${user.getUserId()}">
                </label>
            </div>
            <div class="label-container">
                <label for="nickNameInput" class="control-label">
                    <span class="star">*</span>
                    <span>닉네임</span>
                </label>
                <label class="input-container">
                    <span hidden>닉네임</span>
                    <input class="input input-blue" id="nickNameInput" maxlength="12" name="nickname" type="text"
                           th:value="${user.getNickname()}">
                </label>
            </div>
            <div class="label-container">
                <label for="profileUploadInput" class="control-label">
                    <span>프로필 사진</span>
                </label>
                <div class="profile-upload-container">
                    <label class="input-container">
                        <span hidden>프로필 사진</span>
                        <div class="image-container">
                            <img class="image" th:if="${user.getProfileId() != null && user.getProfileId() != ''}"
                                 th:src="@{'/user/profile-id?id=' + ${user.getProfileId()}}">
                        </div>
                        <div class="file-upload">
                            <a th:href="@{/user/my-page/memberModifyInfo/delete (id=${user.getProfileId()}, uid=${user.getIndex()})}" th:if="${user.getProfileId() != null && user.getProfileId() != ''}" class="input delete-button">삭제</a>
                            <input hidden type="text" name="profileId">
                            <input class="input input-profile-image" id="profileUploadInput" name="profileImage" type="file" accept="image/png, image/jpeg, image/jpg, image/gif" th:classappend="${user.getProfileId() != null && user.getProfileId() != ''} ? 'on'">
                        </div>
                    </label>
                    <div class="input-text">가로 제한 길이: 50px, 세로 제한 길이: 50px</div>
                </div>
            </div>
            <div class="label-container">
                <label class="control-label">
                    <span>메일링 가입</span>
                </label>
                <div class="permission-container">
                    <label class="radio-container">
                        <span hidden>메일링 가입 동의</span>
                        <input class="input" name="mailReceived" type="radio" value="1" th:checked="${user.isMailReceived() == true}"><span>예</span>
                    </label>
                    <label class="radio-container">
                        <span hidden>메일링 가입 미동의</span>
                        <input class="input" name="mailReceived" type="radio" value="0" th:checked="${user.isMailReceived() == false}"><span>아니오</span>
                    </label>
                </div>
            </div>
            <div class="label-container">
                <label class="control-label">
                    <span>쪽지허용</span>
                </label>
                <div class="permission-container">
                    <label class="radio-container">
                        <span hidden>모두 허용</span>
                        <input class="input" name="messageReceptionIndex" type="radio" value="1" th:checked="${user.getMessageReceptionIndex() == 1}"><span>모두 허용</span>
                    </label>
                    <label class="radio-container">
                        <span hidden>등록된 친구들만 허용</span>
                        <input class="input" name="messageReceptionIndex" type="radio" value="2" th:checked="${user.getMessageReceptionIndex() == 2}"><span>등록된 친구들만 허용</span>
                    </label>
                    <label class="radio-container">
                        <span hidden>모두 금지</span>
                        <input class="input" name="messageReceptionIndex" type="radio" value="3" th:checked="${user.getMessageReceptionIndex() == 3}"><span>모두 금지</span>
                    </label>
                </div>
            </div>
            <div class="submit-container">
                <a class="button cancel-button" th:href="@{/user/my-page/memberInfo}">취소</a>
                <input class="button register-button" name="Registration" type="submit" value="등록">
            </div>
        </section>
    </form>
</main>
<th:block th:replace="~{fragments/footer.html :: content}"></th:block>
</body>
</html>